import random
from decimal import Decimal

def _fmt(amount: Decimal) -> str:
    try:
        return f"{amount:.0f}"
    except Exception:
        return str(amount)

def generate_motivation(event: str, amount: Decimal | None = None, ctx: dict | None = None) -> str:
    ctx = ctx or {}
    amount_s = _fmt(amount) if amount is not None else None

    if event == "debt_closed":
        person = ctx.get("person_name") or "—á–µ–ª–æ–≤–µ–∫"
        variants = [
            f"–ö—Ä–∞—Å–∞–≤—á–∏–∫! –ó–∞–∫—Ä—ã–ª –¥–æ–ª–≥ –ø–µ—Ä–µ–¥ {person} ‚úÖ –≠—Ç–æ –¥–∏—Å—Ü–∏–ø–ª–∏–Ω–∞ –∏ –∫–æ–Ω—Ç—Ä–æ–ª—å.",
            f"–ú–∏–Ω—É—Å –¥–æ–ª–≥ ‚Äî –º–∏–Ω—É—Å —Å—Ç—Ä–µ—Å—Å üí™ –û—Ç–ª–∏—á–Ω—ã–π —à–∞–≥, –ø—Ä–æ–¥–æ–ª–∂–∞–π —Ç–∞–∫ –∂–µ.",
            f"–¢—ã –∑–∞–∫—Ä—ã–≤–∞–µ—à—å –æ–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞ ‚Äî —ç—Ç–æ —É—Ä–æ–≤–µ–Ω—å. –î–µ—Ä–∂–∏ —Ç–µ–º–ø ‚úÖ",
        ]
        return random.choice(variants)

    if event == "salary_received":
        variants = [
            f"–ó–∞—Ä–ø–ª–∞—Ç–∞ –ø—Ä–∏—à–ª–∞ üí∞ +{amount_s} KGS. –°–Ω–∞—á–∞–ª–∞ –æ—Ç–ª–æ–∂–∏ —á–∞—Å—Ç—å –≤ –∑–∞–ø–∞—Å, –ø–æ—Ç–æ–º —Ç—Ä–∞—Ç—ã.",
            f"–ï—Å—Ç—å –¥–æ—Ö–æ–¥ ‚úÖ {amount_s} KGS. –°–¥–µ–ª–∞–π –ø–ª–∞–Ω: –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ ‚Üí –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è ‚Üí –æ—Å—Ç–∞–ª—å–Ω–æ–µ.",
            f"–û—Ç–ª–∏—á–Ω–æ! +{amount_s} KGS. –¢–µ–ø–µ—Ä—å —Ç—ã —É–ø—Ä–∞–≤–ª—è–µ—à—å –¥–µ–Ω—å–≥–∞–º–∏, –∞ –Ω–µ –Ω–∞–æ–±–æ—Ä–æ—Ç.",
        ]
        return random.choice(variants)

    if event == "big_expense":
        variants = [
            f"–ë–æ–ª—å—à–æ–π —Ä–∞—Å—Ö–æ–¥ {amount_s} KGS ‚Äî –æ–∫. –ì–ª–∞–≤–Ω–æ–µ: –ø—Ä–æ–≤–µ—Ä—å –±–∞–ª–∞–Ω—Å –∏ –Ω–µ –ø–µ—Ä–µ–≥—Ä—É–∑–∏ –±—é–¥–∂–µ—Ç.",
            f"–†–∞—Å—Ö–æ–¥ {amount_s} KGS. –ï—Å–ª–∏ —ç—Ç–æ –ø–æ –ø–ª–∞–Ω—É ‚Äî —Å—É–ø–µ—Ä. –ï—Å–ª–∏ –Ω–µ—Ç ‚Äî –∫–æ–º–ø–µ–Ω—Å–∏—Ä—É–µ–º –Ω–∞ –Ω–µ–¥–µ–ª–µ.",
        ]
    if event == "debt_created":
        person = (ctx.get("person_name") or "—á–µ–ª–æ–≤–µ–∫")
        kind = ctx.get("kind")

        if kind == "PAYABLE":
            variants = [
                f"–¢—ã –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–ª –¥–æ–ª–≥ –ø–µ—Ä–µ–¥ {person}. –≠—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ ‚úÖ –ü–æ—Å—Ç–∞–≤—å —Å—Ä–æ–∫ –∏ –∑–∞–∫—Ä—ã–≤–∞–π –ø–æ –ø–ª–∞–Ω—É.",
                f"–û–∫, –¥–æ–ª–≥ –¥–æ–±–∞–≤–ª–µ–Ω. –ì–ª–∞–≤–Ω–æ–µ ‚Äî –¥–µ—Ä–∂–∏ –∫–æ–Ω—Ç—Ä–æ–ª—å –∏ –Ω–µ –æ—Ç–∫–ª–∞–¥—ã–≤–∞–π –Ω–∞–¥–æ–ª–≥–æ üí™",
            ]
        else:  # RECEIVABLE
            variants = [
                f"–û—Ç–ª–∏—á–Ω–æ, —Ç—ã –æ—Ç–º–µ—Ç–∏–ª —á—Ç–æ —Ç–µ–±–µ –¥–æ–ª–∂–Ω—ã ({person}) ‚úÖ –¢–∞–∫ –ø—Ä–æ—â–µ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å –≤–æ–∑–≤—Ä–∞—Ç.",
                f"–ó–∞–ø–∏—Å–∞–ª –¥–æ–ª–≥ ‚Äî –∑–Ω–∞—á–∏—Ç –Ω–µ –∑–∞–±—É–¥–µ—à—å. –î–∞–ª—å—à–µ –ø—Ä–æ—Å—Ç–æ: —Å—Ä–æ–∫, –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ, –≤–æ–∑–≤—Ä–∞—Ç üëç",
            ]
        return random.choice(variants)


    return "–¢—ã –º–æ–ª–æ–¥–µ—Ü. –ú–∞–ª–µ–Ω—å–∫–∏–µ —à–∞–≥–∏ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –¥–∞—é—Ç –±–æ–ª—å—à–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç ‚úÖ"
